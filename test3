---
- name: parseJarManifest | Read jar manifest
  shell: >
    unzip -q -c {{ item.path }} META-INF/MANIFEST.MF
    | grep -Ei 'Implementation-Version|Distribution-Filename|Build-Timestamp'
  register: manifest_details
  loop: "{{ jar_name }}"
  loop_control:
    label: "{{ item.path }}"
  failed_when: "manifest_details.rc == 2"
  tags:
    - skip_ansible_lint
    - find_manifest

- name: parseJarManifests | append to collector
  set_fact:
    manifest_collector: "{{ manifest_collector | default({}) | combine({item.item.path: item.stdout_lines}) }}"
  loop: "{{ manifest_details.results }}"
  loop_control:
    label: "{{ item.item.path }}"

- name: parseJarManifests | print the collector
  debug:
    var: manifest_collector
    verbosity: 3
