 - name: deployFPPSAPI  | Inspect {{ deployment_filename }}
      shell: |
        set -o pipefail
        unzip -l {{ archive_name.dest }} | grep .tar.gz | wc -l
      register: unzip_content 

    - name: deployFPPSAPI  | Unarchive {{ deployment_filename }}
      unarchive:
        src: "{{ archive_name.dest }}"
        dest: "{{ local_stage_path }}"
        remote_src: true
      delegate_to: "{{ inventory_hostname }}"
      register: unarchive_file
      when: unzip_content.stdout | int > 1

    - name: deployFPPSAPI  | Copy {{ deployment_filename }} to {{ local_stage_path }}
      copy:
        src: "{{ archive_name.dest }}"
        dest: "{{ local_stage_path }}"
        remote_src: true
      delegate_to: "{{ inventory_hostname }}"
      register: war_contents
      when: unzip_content.stdout | int < 2

 - name: deployFPPSAPI  | Extract tar to  {{ release_path }}
      command: "tar -xvf {{ local_stage_path }}/{{ deployment_tar_file.split('/')[-1] }} -C {{ release_path }}/"
      when: unzip_content.stdout | int > 1
      tags:
        - skip_ansible_lint
